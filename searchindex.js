Search.setIndex({"docnames": ["howto/eam-forces", "howto/force-field-training", "howto/index", "howto/property-regression", "howto/test", "index", "overview", "reference/api", "reference/atoms", "reference/dataset", "reference/generated/nfflr.Atoms", "reference/generated/nfflr.AtomsDataset", "reference/generated/nfflr.batch", "reference/generated/nfflr.data.deepmd_hea_dataset", "reference/generated/nfflr.data.mlearn_dataset", "reference/generated/nfflr.data.vasprun_dataset", "reference/generated/nfflr.models.ALIGNN", "reference/generated/nfflr.models.SchNet", "reference/generated/nfflr.models.Tersoff", "reference/generated/nfflr.nn.ALIGNNConv", "reference/generated/nfflr.nn.AtomPairType", "reference/generated/nfflr.nn.AtomType", "reference/generated/nfflr.nn.AtomicNumberEmbedding", "reference/generated/nfflr.nn.AttributeEmbedding", "reference/generated/nfflr.nn.ChebyshevExpansion", "reference/generated/nfflr.nn.Cosine", "reference/generated/nfflr.nn.EdgeGatedGraphConv", "reference/generated/nfflr.nn.FeedForward", "reference/generated/nfflr.nn.InstanceNorm", "reference/generated/nfflr.nn.MLPLayer", "reference/generated/nfflr.nn.Norm", "reference/generated/nfflr.nn.PeriodicTableEmbedding", "reference/generated/nfflr.nn.RBFExpansion", "reference/generated/nfflr.nn.SparseALIGNNConv", "reference/generated/nfflr.nn.XPLOR", "reference/generated/nfflr.nn.transform.PeriodicAdaptiveRadiusGraph", "reference/generated/nfflr.nn.transform.PeriodicKShellGraph", "reference/generated/nfflr.nn.transform.PeriodicRadiusGraph", "reference/generated/nfflr.spglib_cell", "reference/generated/nfflr.to_ase", "reference/generated/nfflr.train.TrainingConfig", "reference/generated/nfflr.train.lr", "reference/generated/nfflr.train.train", "reference/generated/nfflr.train.trainer.get_dataflow", "reference/generated/nfflr.train.trainer.setup_checkpointing", "reference/generated/nfflr.train.trainer.setup_evaluators", "reference/generated/nfflr.train.trainer.setup_model_and_optimizer", "reference/generated/nfflr.train.trainer.setup_trainer", "reference/generated/nfflr.unbatch", "reference/index", "reference/models", "reference/nn", "reference/trainer", "tutorials/atoms", "tutorials/index", "tutorials/quickstart"], "filenames": ["howto/eam-forces.ipynb", "howto/force-field-training.ipynb", "howto/index.md", "howto/property-regression.ipynb", "howto/test.ipynb", "index.md", "overview.md", "reference/api.md", "reference/atoms.md", "reference/dataset.md", "reference/generated/nfflr.Atoms.rst", "reference/generated/nfflr.AtomsDataset.rst", "reference/generated/nfflr.batch.rst", "reference/generated/nfflr.data.deepmd_hea_dataset.rst", "reference/generated/nfflr.data.mlearn_dataset.rst", "reference/generated/nfflr.data.vasprun_dataset.rst", "reference/generated/nfflr.models.ALIGNN.rst", "reference/generated/nfflr.models.SchNet.rst", "reference/generated/nfflr.models.Tersoff.rst", "reference/generated/nfflr.nn.ALIGNNConv.rst", "reference/generated/nfflr.nn.AtomPairType.rst", "reference/generated/nfflr.nn.AtomType.rst", "reference/generated/nfflr.nn.AtomicNumberEmbedding.rst", "reference/generated/nfflr.nn.AttributeEmbedding.rst", "reference/generated/nfflr.nn.ChebyshevExpansion.rst", "reference/generated/nfflr.nn.Cosine.rst", "reference/generated/nfflr.nn.EdgeGatedGraphConv.rst", "reference/generated/nfflr.nn.FeedForward.rst", "reference/generated/nfflr.nn.InstanceNorm.rst", "reference/generated/nfflr.nn.MLPLayer.rst", "reference/generated/nfflr.nn.Norm.rst", "reference/generated/nfflr.nn.PeriodicTableEmbedding.rst", "reference/generated/nfflr.nn.RBFExpansion.rst", "reference/generated/nfflr.nn.SparseALIGNNConv.rst", "reference/generated/nfflr.nn.XPLOR.rst", "reference/generated/nfflr.nn.transform.PeriodicAdaptiveRadiusGraph.rst", "reference/generated/nfflr.nn.transform.PeriodicKShellGraph.rst", "reference/generated/nfflr.nn.transform.PeriodicRadiusGraph.rst", "reference/generated/nfflr.spglib_cell.rst", "reference/generated/nfflr.to_ase.rst", "reference/generated/nfflr.train.TrainingConfig.rst", "reference/generated/nfflr.train.lr.rst", "reference/generated/nfflr.train.train.rst", "reference/generated/nfflr.train.trainer.get_dataflow.rst", "reference/generated/nfflr.train.trainer.setup_checkpointing.rst", "reference/generated/nfflr.train.trainer.setup_evaluators.rst", "reference/generated/nfflr.train.trainer.setup_model_and_optimizer.rst", "reference/generated/nfflr.train.trainer.setup_trainer.rst", "reference/generated/nfflr.unbatch.rst", "reference/index.md", "reference/models.md", "reference/nn.md", "reference/trainer.md", "tutorials/atoms.ipynb", "tutorials/index.md", "tutorials/quickstart.ipynb"], "titles": ["Check autograd forces against analytical forces", "Train a force field from scratch", "How-to guides", "Property regression example", "an example", "NFFLr documentation", "Overview", "nfflr", "nfflr.Atoms", "nfflr.AtomsDataset", "Atoms", "AtomsDataset", "nfflr.batch", "nfflr.data.deepmd_hea_dataset", "nfflr.data.mlearn_dataset", "nfflr.data.vasprun_dataset", "ALIGNN", "SchNet", "Tersoff", "ALIGNNConv", "AtomPairType", "AtomType", "AtomicNumberEmbedding", "AttributeEmbedding", "ChebyshevExpansion", "Cosine", "EdgeGatedGraphConv", "FeedForward", "InstanceNorm", "MLPLayer", "Norm", "PeriodicTableEmbedding", "RBFExpansion", "SparseALIGNNConv", "XPLOR", "PeriodicAdaptiveRadiusGraph", "PeriodicKShellGraph", "PeriodicRadiusGraph", "nfflr.spglib_cell", "nfflr.to_ase", "TrainingConfig", "nfflr.train.lr", "nfflr.train.train", "nfflr.train.trainer.get_dataflow", "nfflr.train.trainer.setup_checkpointing", "nfflr.train.trainer.setup_evaluators", "nfflr.train.trainer.setup_model_and_optimizer", "nfflr.train.trainer.setup_trainer", "nfflr.unbatch", "Reference", "nfflr.models", "nfflr.nn", "trainer", "Atoms", "Tutorials", "Quickstart"], "terms": {"thi": [0, 1, 3, 4, 6, 7, 26, 55], "notebook": [0, 1, 3, 53, 55], "compar": 0, "comput": [0, 1, 10, 37, 55], "automat": [0, 3, 55], "differenti": [0, 55], "respect": [0, 14, 55], "bond": [0, 1, 16, 18, 55], "vector": [0, 6, 18, 55], "atom": [0, 1, 3, 4, 6, 11, 12, 16, 17, 20, 21, 37, 38, 39, 40, 48, 49, 54], "coordin": [0, 10, 55], "al99": 0, "embed": [0, 1, 3, 4, 6, 31], "implement": [0, 6, 18, 55], "ASE": 0, "first": [0, 3], "fetch": [0, 1], "eam": 0, "data": [0, 1, 3, 4, 6, 10, 40, 49, 52, 53, 54], "from": [0, 2, 3, 6, 14, 15, 26, 53, 55], "interatom": [0, 32, 49], "repositori": 0, "curl": 0, "http": [0, 1, 3, 18, 26, 53, 55], "www": [0, 3, 18, 55], "ctcm": [0, 18], "nist": [0, 5, 18], "gov": [0, 5, 18], "download": [0, 14], "1999": 0, "mishin": 0, "y": [0, 1, 3, 16, 19, 33], "farka": 0, "d": [0, 1, 4, 18], "mehl": 0, "m": [0, 1, 18], "j": [0, 18, 26], "papaconstantopoulo": 0, "A": [0, 1, 6, 18], "al": [0, 26], "2": [0, 1, 3, 4, 6, 11, 18, 26, 53, 55], "alloi": 0, "o": [0, 1], "total": [0, 11, 17, 55], "receiv": 0, "xferd": 0, "averag": [0, 17], "speed": 0, "time": [0, 1, 55], "current": [0, 1, 4, 6, 55], "dload": 0, "upload": 0, "spent": 0, "left": [0, 25], "0": [0, 1, 3, 4, 6, 11, 13, 18, 25, 32, 34, 35, 36, 37, 40, 41, 42, 53, 55], "100": [0, 1, 3, 4, 25, 34, 55], "762k": 0, "3592k": 0, "3612k": 0, "gradient": [0, 3, 55], "i": [0, 1, 3, 4, 5, 6, 10, 11, 18, 26, 55], "best": [0, 1], "done": [0, 1], "64": [0, 3, 16, 22, 23, 31], "bit": [0, 1], "float": [0, 11, 13, 18, 25, 28, 32, 34, 35, 36, 37, 40], "point": [0, 1, 41, 42, 55], "precis": 0, "pathlib": [0, 1, 3, 6], "import": [0, 1, 3, 4, 6, 53, 55], "path": [0, 1, 3, 6, 11, 13, 15, 40], "torch": [0, 1, 3, 4, 6, 10, 25, 26, 34, 35, 36, 37, 41, 42, 46, 53, 55], "ase": [0, 39, 53, 55], "calcul": [0, 11], "build": 0, "bulk": 0, "nfflr": [0, 1, 2, 4, 6, 10, 11, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 40, 49, 52, 53, 55], "graph": [0, 1, 3, 4, 6, 11, 16, 18, 19, 26, 33, 35, 36, 37, 49, 55], "model": [0, 3, 4, 5, 16, 17, 18, 40, 41, 42, 44, 45, 46, 47, 49, 52, 54], "classic": [0, 4, 49], "torcheam": 0, "set_default_dtyp": [0, 4], "float64": [0, 4], "opt": [0, 1, 3, 4, 53, 55], "hostedtoolcach": [0, 1, 3, 4, 53, 55], "python": [0, 1, 3, 4, 53, 55], "3": [0, 1, 3, 4, 6, 18, 26, 34, 40, 53, 55], "10": [0, 1, 3, 4, 18, 26, 53, 55], "13": [0, 1, 3, 4, 53, 55], "x64": [0, 1, 3, 4, 53, 55], "lib": [0, 1, 3, 4, 53, 55], "python3": [0, 1, 3, 4, 53, 55], "site": [0, 1, 3, 4, 53, 55], "packag": [0, 1, 3, 4, 49, 53, 55], "tqdm": [0, 1, 3, 53, 55], "auto": [0, 1, 3, 6, 53, 55], "py": [0, 3, 4, 6, 53, 55], "21": [0, 1, 3, 53, 55], "tqdmwarn": [0, 1, 3, 53, 55], "iprogress": [0, 1, 3, 53, 55], "found": [0, 1, 3, 53, 55], "pleas": [0, 1, 3, 5, 53, 55], "updat": [0, 1, 3, 16, 19, 26, 33, 53, 55], "jupyt": [0, 1, 3, 53, 55], "ipywidget": [0, 1, 3, 53, 55], "see": [0, 1, 3, 5, 26, 53, 55], "readthedoc": [0, 1, 3, 53, 55], "io": [0, 1, 3, 53, 55], "en": [0, 1, 3, 53, 55], "stabl": [0, 1, 3, 53, 55], "user_instal": [0, 1, 3, 53, 55], "html": [0, 1, 3, 18, 26, 53, 55], "autonotebook": [0, 1, 3, 53, 55], "notebook_tqdm": [0, 1, 3, 53, 55], "2024": [0, 1, 3, 53, 55], "03": [0, 1, 3, 53, 55], "08": [0, 1, 3, 53, 55], "20": [0, 1, 3, 6, 53, 55], "06": [0, 1, 3, 28, 55], "50": [0, 4], "341": 0, "info": [0, 1, 3, 53, 55], "util": [0, 2, 3, 6, 52, 53, 54], "154": [0, 1, 3, 53, 55], "miss": [0, 1, 3, 53, 55], "run": [0, 2, 3, 4, 6, 41, 53, 55], "pip": [0, 1, 3, 5, 53, 55], "instal": [0, 1, 3, 4, 5, 53, 55], "u": [0, 1, 3, 26, 53, 55], "restart": [0, 1, 3, 53, 55], "server": [0, 1, 3, 53, 55], "rich": [0, 1, 3, 53, 55], "output": [0, 1, 3, 17, 53, 55], "495": 0, "modulenotfounderror": 0, "traceback": [0, 1, 3, 4], "most": [0, 1, 3, 4, 55], "recent": [0, 1, 3, 4], "call": [0, 1, 3, 4, 55], "last": [0, 1, 3, 4], "cell": [0, 1, 3, 4, 10, 53, 55], "In": [0, 1, 3, 4], "line": [0, 1, 3, 4, 6, 16, 19, 33], "9": [0, 1, 3, 4, 13, 55], "7": [0, 1, 3, 4, 18, 55], "8": [0, 1, 3, 4, 11, 32, 55], "11": [0, 1, 3, 4], "file": [0, 2, 3, 4, 5, 6, 15], "work": [0, 3, 4, 5, 10], "12": [0, 1, 3, 4, 36], "nn": [0, 1, 3, 4, 6, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 41, 42, 46, 49], "torchcubicsplin": 0, "natural_cubic_spline_coeff": 0, "naturalcubicsplin": 0, "14": [0, 1, 3, 4, 55], "17": [0, 3, 53, 55], "dataclass": [0, 1, 4], "18": [0, 3], "class": [0, 1, 3, 4, 10, 11, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 40], "eamdata": 0, "No": [0, 1], "modul": [0, 4, 13, 14, 15, 16, 17, 40, 41, 42, 46, 55], "name": [0, 1, 3, 4, 6, 55], "we": [0, 1, 3, 4, 55], "set": [0, 1, 3, 6, 55], "up": [0, 1, 3], "fcc": 0, "aluminum": 0, "add": [0, 26], "amount": 0, "jitter": 0, "4": [0, 1, 3, 4, 6, 16, 17, 18, 25, 34, 53, 55], "05": [0, 3, 40], "al_as": 0, "rattl": 0, "stdev": 0, "wrap": [0, 1, 43], "ase_eam": 0, "set_calcul": 0, "pytorch": [0, 1, 3, 4, 55], "version": [0, 1, 3, 4, 55], "get_cel": 0, "arrai": [0, 4, 10, 55], "get_scaled_posit": 0, "number": [0, 1, 10, 53, 55], "torch_eam": 0, "dtype": [0, 1, 3, 4, 35, 36, 37, 55], "The": [0, 1, 3, 5, 6, 10, 52, 55], "us": [0, 1, 2, 4, 5, 6, 55], "spline": 0, "compon": [0, 1, 3, 5, 55], "while": 0, "energi": [0, 1, 3, 4, 6, 11, 17, 55], "displac": 0, "sum": 0, "reduct": 0, "aggreg": 0, "individu": 0, "both": [0, 1, 3, 6, 26, 55], "all": [0, 1, 4, 55], "match": [0, 1, 4], "within": 0, "construct": [0, 1, 6, 14, 15, 36, 49], "radiu": [0, 25, 34, 35, 36, 37], "cutoff": [0, 1, 3, 4, 6, 16, 17, 18, 25, 34, 35, 36, 37, 49], "g": [0, 1, 3, 4, 6, 10, 12, 15, 16, 18, 19, 26, 33, 55], "periodic_radius_graph": [0, 3, 4, 55], "r": [0, 3, 4, 18, 25, 34, 55], "evalu": [0, 2, 18, 45], "e_dgl": 0, "force_dgl": 0, "detach": [0, 1, 4], "e_as": 0, "get_potential_energi": 0, "force_as": 0, "get_forc": 0, "print": [0, 3, 55], "f": [0, 1, 4, 25, 55], "item": [0, 1, 3], "np": [0, 1, 3, 4], "isclos": 0, "user": [0, 1, 3, 4], "bld": [0, 1, 3, 4], "pyenv": [0, 1, 3, 4], "env": [0, 1, 3, 4], "dgl": [0, 1, 3, 4, 6, 11, 12, 16, 18, 26, 36], "backend": [0, 1, 3, 4, 5, 6], "tensor": [0, 1, 3, 4, 6, 10, 11, 18, 19, 20, 21, 26, 27, 32, 33, 53, 55], "445": [0, 1, 3, 4], "userwarn": [0, 1, 3, 4], "typedstorag": [0, 1, 3, 4], "deprec": [0, 1, 3, 4], "It": [0, 1, 3, 4], "remov": [0, 1, 3, 4], "futur": [0, 1, 3, 4], "untypedstorag": [0, 1, 3, 4], "onli": [0, 1, 3, 4, 26], "storag": [0, 1, 3, 4], "should": [0, 1, 3, 4, 6, 44], "matter": [0, 1, 3, 4], "you": [0, 1, 3, 4], "ar": [0, 1, 3, 4, 5, 6, 10, 11, 55], "directli": [0, 1, 3, 4, 55], "To": [0, 1, 3, 4, 6], "access": [0, 1, 3, 4], "untyped_storag": [0, 1, 3, 4], "instead": [0, 1, 3, 4], "assert": [0, 1, 3, 4], "input": [0, 1, 3, 4, 5, 19, 26, 33], "numel": [0, 1, 3, 4], "size": [0, 2, 3, 4, 10], "214": 0, "15885773313198": 0, "15885773313158": 0, "true": [0, 1, 3, 4, 6, 18, 20, 26, 40, 55], "section": 0, "perform": [0, 5], "same": [0, 3, 55], "diagnost": 0, "lammp": [0, 18], "demonstr": 0, "rel": [0, 18], "posit": [0, 1, 10, 53, 55], "reduc": [0, 1], "correct": [0, 1], "paramet": [0, 3, 4, 10, 18, 25, 26, 34, 36, 40, 41, 42, 43], "correspond": [0, 18], "entri": [0, 18, 41, 42], "1988": [0, 18], "si": [0, 1, 14, 18], "b": [0, 1, 18, 26], "1": [0, 1, 3, 4, 11, 13, 16, 17, 18, 24, 25, 26, 40, 53, 55], "1988_si": 0, "cat": [0, 26], "532": 0, "49": [0, 3], "00": [0, 1, 3, 55], "143": 0, "02": [0, 1, 3, 55], "citat": 0, "phy": [0, 18], "rev": [0, 18], "37": [0, 3, 18], "6991": [0, 18], "valu": [0, 18, 55], "verifi": 0, "luca": 0, "hale": 0, "ident": 0, "august": 0, "22": [0, 3, 18, 26, 53, 55], "2018": [0, 26], "distribut": [0, 1, 3, 6, 52], "openkim": 0, "mo_245095684871_001": 0, "metal": 0, "unit": 0, "e1": [0, 18], "e2": [0, 18], "e3": [0, 18], "gamma": [0, 18], "lambda3": [0, 18], "c": [0, 1, 3, 4, 18, 26], "costheta0": [0, 18], "n": [0, 1, 18, 24, 26, 55], "beta": [0, 18], "lambda2": [0, 18], "lambda1": [0, 18], "3258": [0, 18], "8381": [0, 18], "0417": [0, 18], "956": [0, 18], "33675": [0, 18], "95": [0, 1, 3, 4, 18], "373": [0, 18], "2394": [0, 18], "3264": [0, 18], "seem": [0, 1], "still": [0, 1], "have": [0, 1, 4, 6, 55], "issu": [0, 1, 5], "pars": [0, 1], "thermo": 0, "log": [0, 4, 40], "can": [0, 1, 3, 4, 5, 6, 55], "around": [0, 1], "short": 0, "term": [0, 18], "monkei": 0, "patch": 0, "read_lammps_log": 0, "follow": [0, 18], "discuss": [0, 5, 26], "here": [0, 1, 4, 55], "lammpsrun": 0, "parallel": [0, 6, 52], "paropen": 0, "re": [0, 1, 4], "compil": 0, "re_compil": 0, "ignorecas": 0, "calculation_end_mark": 0, "def": [0, 1, 3, 4], "self": [0, 1, 3, 16], "lammps_log": 0, "none": [0, 1, 4, 10, 11, 13, 14, 15, 16, 17, 27, 30, 32, 33, 40, 53, 55], "thermo_arg": 0, "calc": 0, "base": [0, 1, 2, 5, 49], "gitlab": 0, "com": [0, 3, 14, 55], "1096": 0, "method": [0, 10, 11, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 40], "which": [0, 1, 3, 4, 14, 55], "read": [0, 5], "label": [0, 1, 4], "isinst": 0, "str": [0, 6, 11, 13, 14, 16, 17, 18], "fileobj": 0, "rb": [0, 1], "close_log_fil": 0, "els": [0, 1, 4], "expect": [0, 55], "lammps_in": 0, "like": [0, 1, 6, 55], "object": [0, 3], "fals": [0, 1, 3, 4, 10, 11, 13, 14, 15, 16, 17, 20, 21, 26, 27, 33, 40], "read_log": 0, "depend": [0, 1, 6], "three": 0, "thermo_styl": 0, "custom": [0, 1, 3, 6], "arg": [0, 1, 3], "capit": 0, "e": [0, 1, 6, 10, 15, 55], "don": 0, "t": [0, 4], "ke": 0, "cpu": [0, 1, 4, 10], "kineng": 0, "mark_r": 0, "": [0, 1, 3, 6, 43, 55], "join": 0, "x": [0, 4, 6, 16, 19, 24, 27, 29, 33, 37, 38], "_custom_thermo_mark": 0, "todo": 0, "regex": 0, "magic": 0, "necessari": 0, "someth": 0, "convert": [0, 5, 10, 39, 55], "f_re": 0, "nan": 0, "inf": 0, "n_arg": 0, "len": [0, 1], "creat": [0, 1, 47], "exactli": 0, "white": 0, "space": [0, 1], "separ": 0, "floatish": 0, "thing": 0, "_custom_thermo_r": 0, "flag": 0, "thermo_cont": 0, "readlin": 0, "decod": 0, "utf": [0, 1], "strip": 0, "error": [0, 1, 4], "close": 0, "rais": [0, 4], "runtimeerror": 0, "exit": 0, "messag": 0, "get": [0, 11, 55], "bool_match": 0, "dictionari": [0, 55], "between": 0, "each": [0, 18, 55], "append": [0, 1, 3, 4], "dict": [0, 6, 11, 44], "zip": [0, 1], "map": [0, 3], "group": 0, "return": [0, 1, 3, 4, 6, 10, 26, 36, 55], "parser": 0, "now": [0, 1, 3], "serv": 0, "refer": [0, 1, 3, 18, 26, 55], "exampl": [0, 2, 25, 34, 55], "crystal": [0, 11, 16, 26], "si_as": 0, "diamond": 0, "5": [0, 1, 3, 4, 25, 34, 35, 37, 53, 55], "43": [0, 26], "01": [0, 1, 3, 4, 40, 55], "seed": 0, "36": 0, "configur": [0, 2, 3, 5, 6, 40, 43, 44, 45, 49, 55], "command": [0, 1], "homebrew": 0, "bin": [0, 4, 32], "lmp_serial": 0, "binary_dump": 0, "pair_styl": 0, "pair_coeff": 0, "e_lammp": 0, "f_lammp": 0, "592": 0, "398567149167": 0, "20522987": 0, "26851818": 0, "14179856": 0, "06219078": 0, "05221548": 0, "0728464": 0, "03842853": 0, "02849059": 0, "04544221": 0, "21198316": 0, "12308603": 0, "00683117": 0, "5269759": 0, "12608296": 0, "29867076": 0, "And": [0, 1], "out": [0, 1, 3], "e_tersoff": 0, "total_energi": [0, 4, 6], "f_tersoff": 0, "stress_tersoff": 0, "stress": [0, 6, 11, 55], "get_volum": 0, "3986": 0, "2052": 0, "2685": 0, "1418": 0, "0622": 0, "0522": 0, "0728": 0, "0384": 0, "0285": 0, "0454": 0, "2120": 0, "1231": 0, "0068": 0, "5270": 0, "1261": 0, "2987": 0, "6": [0, 3, 4, 55], "5235e": 0, "04": [0, 3], "6092e": 0, "2400e": 0, "5744e": 0, "0972e": 0, "4832e": 0, "numer": 0, "so": [0, 1, 17, 55], "do": 0, "gradcheck": 0, "atol": 0, "1e": [0, 1, 3, 4, 6, 28, 40], "rtol": 0, "001": 0, "largest": 0, "discrep": 0, "about": [0, 3], "ev": [0, 1, 4, 6, 11, 16, 17], "mathrm": [0, 4], "aa": [0, 4], "numpi": [0, 3, 13], "max": [0, 1, 55], "749736085540081e": 0, "07": [0, 1, 3, 55], "also": [0, 3, 6, 55], "get_stress": 0, "52352915e": 0, "57444097e": 0, "48324331e": 0, "09715783e": 0, "23995521e": 0, "60922348e": 0, "voigt_6_to_full_3x3_stress": 0, "guid": 1, "show": [1, 3, 4, 25, 34], "how": [1, 3], "trainer": [1, 2, 5, 42, 49], "ll": 1, "focu": 1, "small": [1, 2, 3], "alignn": [1, 3, 5, 17, 19, 33, 49, 55], "mlearn": [1, 4, 14, 55], "silicon": [1, 2], "singl": [1, 6], "alloc": 1, "an": [1, 3, 5, 6, 15, 26, 52, 55], "interact": [1, 4, 26, 55], "session": 1, "final": 1, "plot": [1, 3, 4, 25, 34, 53, 55], "metric": [1, 40, 45], "properti": [1, 2, 11, 26, 55], "start": [1, 3, 16, 55], "defin": [1, 3, 6, 36], "variabl": [1, 3, 55], "argument": 1, "trainingconfig": [1, 6, 41, 42, 43, 44, 46, 47, 49], "alignnff": [1, 6], "case": 1, "atomsdataset": [1, 3, 4, 15, 41, 42, 43, 46, 49], "yield": [1, 55], "target": [1, 3, 4, 6, 11, 55], "runner": [1, 3], "arbitrari": 1, "allow": [1, 6, 55], "requir": [1, 4, 55], "mai": [1, 6], "appear": 1, "ani": [1, 11, 55], "order": 1, "addit": [1, 31], "usual": 1, "hyperparamet": [1, 16, 17], "relat": 1, "actual": 1, "optim": [1, 3, 4, 6, 40, 44, 46, 47], "process": [1, 40], "learn": [1, 5, 6, 26, 41, 55], "rate": [1, 6, 41], "enabl": [1, 5, 40, 55], "asynchron": [1, 6, 10], "pre": [1, 49], "represent": [1, 5, 10, 49], "diskcach": [1, 11, 13, 14, 15, 40], "directori": [1, 3, 14, 40], "write": 1, "permiss": 1, "fast": [1, 41], "local": 1, "filesystem": 1, "under": 1, "tmp": 1, "dedic": 1, "partit": 1, "hpc": 1, "addition": 1, "non": [1, 55], "zero": 1, "dataloader_work": [1, 6, 40], "help": 1, "latenc": 1, "dure": [1, 40, 55], "If": 1, "slurm": 1, "make": [1, 10, 55], "sure": 1, "request": 1, "larg": [1, 55], "enough": 1, "dataload": [1, 3, 6, 11], "criterion": [1, 3, 6, 40, 46, 47], "multitaskloss": [1, 6], "task": [1, 3, 6], "weight": 1, "experiment_dir": [1, 6, 40], "__file__": [1, 6], "parent": [1, 3, 6], "resolv": [1, 6], "random_se": [1, 3, 6, 40], "42": [1, 3, 6, 11, 40], "epoch": [1, 3, 4, 6, 40], "per_device_batch_s": [1, 6, 40], "weight_decai": [1, 3, 6, 40], "learning_r": [1, 3, 6, 40], "5e": 1, "warmup_step": [1, 40], "initialize_bia": [1, 40], "initialize_estimated_reference_energi": [1, 40], "when": 1, "becom": 1, "bottleneck": 1, "sinc": 1, "transform": [1, 3, 4, 6, 10, 11, 13, 14, 15, 16, 17, 35, 36, 37, 40, 55], "callabl": [1, 11, 16, 17, 40], "straightforward": 1, "wai": [1, 55], "mitig": 1, "function": [1, 3, 4, 6, 18, 26, 32, 49, 52], "precomputed_line_graph_tupl": 1, "precomput": [1, 55], "must": 1, "includ": [1, 6, 55], "oper": [1, 6], "autograd": [1, 2, 3], "trace": 1, "could": [1, 6, 55], "introduc": 1, "predict": [1, 3, 6, 26, 55], "neighbor": [1, 18, 36, 55], "list": [1, 11, 12, 14, 18, 48], "fine": 1, "length": [1, 18], "geometri": 1, "basi": [1, 24, 32, 49], "continu": 1, "rcut": [1, 6], "periodicradiusgraph": [1, 3, 6, 16, 17, 49], "model_cfg": [1, 4, 6], "alignnffconfig": [1, 6], "cosin": [1, 6, 17, 49], "local_cutoff": 1, "atom_featur": [1, 3, 4, 6, 16, 17, 23], "reference_energi": [1, 4, 16, 17], "trainabl": [1, 16, 17], "alignn_lay": [1, 3, 4, 6, 16, 55], "gcn_layer": [1, 3, 4, 6, 16, 55], "compute_forc": [1, 4, 6, 16, 17, 55], "specifi": 1, "reli": [1, 18], "explicit": [1, 3], "specif": [1, 6], "mlearn_dataset": [1, 6, 49], "element": [1, 14], "next": [1, 3], "conduct": 1, "some": [1, 3, 6, 55], "test": [1, 11], "select": [1, 3], "avail": [1, 55], "hardwar": 1, "identifi": 1, "appropri": [1, 3], "potenti": [1, 2, 18, 49], "decai": 1, "our": [1, 5], "finder": [1, 6, 41], "one": 1, "window": 1, "monitor": 1, "nvidia": 1, "smi": 1, "anoth": 1, "cluster": 1, "srun": 1, "pty": 1, "gre": 1, "bash": 1, "conda": 1, "activ": 1, "470": 1, "223": 1, "driver": 1, "cuda": [1, 10], "persist": 1, "bu": 1, "id": [1, 11], "disp": 1, "volatil": 1, "uncorr": 1, "ecc": 1, "fan": 1, "temp": 1, "perf": [1, 4], "pwr": 1, "usag": 1, "cap": 1, "memori": 1, "mig": 1, "tesla": 1, "p100": 1, "pcie": 1, "On": 1, "00000000": 1, "off": [1, 53, 55], "37c": 1, "p0": 1, "26w": 1, "250w": 1, "0mib": [1, 3], "16280mib": 1, "default": [1, 26], "86": 1, "49c": 1, "30w": 1, "ha": [1, 17], "16": [1, 3, 4, 6], "gib": 1, "vram": 1, "becaus": [1, 3], "code": 1, "yet": 1, "For": [1, 3, 6, 55], "given": 1, "throughput": 1, "affect": 1, "chang": [1, 55], "nff": [1, 6], "lr": [1, 3, 4, 6, 49], "nice": [1, 3], "check": [1, 2, 4], "gpustat": 1, "split": [1, 3, 4, 11, 14, 43], "pane": 1, "tmux": 1, "provid": [1, 5, 52, 55], "conveni": [1, 55], "summari": 1, "stat": [1, 4], "refresh": 1, "typic": 1, "give": 1, "reason": [1, 3], "idea": 1, "fluctat": 1, "ctrl": 1, "vertic": 1, "switch": 1, "consist": [1, 5, 6], "hover": 1, "70": 1, "need": [1, 3, 4, 10, 55], "complet": [1, 3, 55], "try": [1, 4], "doubl": 1, "find": 1, "limit": 1, "back": 1, "90": 1, "prudent": 1, "leav": 1, "head": [1, 55], "especi": 1, "high": 1, "lead": 1, "spike": 1, "woe": 1, "fluctuat": 1, "lot": 1, "burst": 1, "low": [1, 2], "indic": [1, 11], "other": [1, 3, 6, 10, 49, 55], "bound": 1, "cannot": [1, 4], "keep": [1, 4], "increas": 1, "worker": 1, "per": 1, "probabl": [1, 4], "workload": 1, "profil": [1, 25, 34], "ve": 1, "exercis": 1, "somewhat": 1, "overkil": 1, "400": 1, "iter": [1, 3, 5, 10, 15], "25": [1, 4, 6], "howev": 1, "often": [1, 3], "fraction": [1, 10], "let": [1, 3], "choos": 1, "peak": 1, "over": 1, "rang": [1, 3, 4], "strategi": 1, "after": 1, "choic": 1, "launch": [1, 6], "onc": 1, "inspect": [1, 3], "loss": [1, 3], "curv": 1, "written": 1, "metric_histori": 1, "pkl": 1, "einop": 1, "matplotlib": [1, 3, 4, 53, 55], "pyplot": [1, 3, 4, 53, 55], "plt": [1, 3, 4, 25, 34, 53, 55], "inlin": [1, 3, 4, 53, 55], "modeldir": 1, "h": 1, "load": [1, 3, 13, 40, 55], "mae_energi": 1, "mae_forc": 1, "n_epoch": 1, "arang": [1, 4], "fig": [1, 4, 53, 55], "ax": [1, 4, 53, 55], "subplot": [1, 4, 53, 55], "nrow": 1, "sharex": 1, "phase": 1, "valid": [1, 43, 45, 55], "set_ylabel": [1, 4], "loglog": [1, 4], "legend": [1, 4], "set_xlabel": [1, 4], "tight_layout": [1, 4], "183": 1, "337": 1, "filenotfounderror": 1, "get_ipython": [1, 4], "run_line_mag": [1, 4], "serial": 1, "998": 1, "map_loc": [1, 4], "pickle_modul": 1, "weights_onli": 1, "mmap": 1, "pickle_load_arg": 1, "995": 1, "encod": 1, "kei": [1, 4, 6, 55], "996": 1, "_open_file_lik": 1, "opened_fil": 1, "999": 1, "_is_zipfil": 1, "1000": [1, 4, 53, 55], "zipfil": [1, 3, 55], "reader": 1, "go": [1, 26], "advanc": 1, "1001": 1, "want": 1, "tail": 1, "jit": 1, "1002": 1, "reset": 1, "origin": 1, "1003": 1, "orig_posit": 1, "tell": 1, "name_or_buff": 1, "mode": [1, 28, 30], "443": 1, "444": 1, "_is_path": 1, "_open_fil": 1, "446": 1, "447": 1, "w": [1, 26], "426": 1, "__init__": [1, 3, 4], "425": 1, "super": 1, "open": 1, "errno": 1, "further": 1, "instanti": 1, "checkpoint": [1, 40, 44], "energy_unit": [1, 4, 6, 11, 16, 17], "load_state_dict": [1, 4], "checkpoint_100": 1, "pt": [1, 4], "successfulli": [1, 4], "project": 1, "84": [1, 3], "copi": 1, "recommend": 1, "sourcetensor": 1, "clone": 1, "requires_grad_": [1, 18], "rather": 1, "than": 1, "ffoutput": 1, "force_p": 1, "collect_result": 1, "e_ref": 1, "e_pr": 1, "f_ref": 1, "f_pred": 1, "_id": 1, "f_p": 1, "pack": 1, "ref": 1, "pred": [1, 3], "ref_t": 1, "pred_t": 1, "ref_v": 1, "pred_v": 1, "val": [1, 3, 4, 11, 43], "pariti": 1, "look": 1, "ncol": [1, 4], "figsiz": [1, 4, 53, 55], "sca": [1, 4], "per_atom": 1, "nt": 1, "flatten": 1, "nv": 1, "ct": 1, "k": [1, 4, 18, 26, 36], "cv": 1, "scatter": [1, 4], "alpha": [1, 4], "linestyl": [1, 4], "color": [1, 4, 53], "xlabel": [1, 3, 4, 25, 34], "e_": 1, "ylabel": [1, 3, 4, 25, 34], "500": 1, "fmax": 1, "axvlin": [1, 4], "linewidth": 1, "axhlin": 1, "f_": [1, 25, 34], "\u00e5": 1, "ylim": [1, 4], "mean": 1, "absolut": 1, "ab": [1, 4], "0456": 1, "0645": 1, "long": 1, "empir": 1, "cumul": 1, "magnitud": 1, "error_ecdf_plot": 1, "quantil": [1, 4], "annot": [1, 4], "gca": 1, "_y": [1, 4], "101": [1, 4, 55], "ecdf": [1, 4], "percentil": [1, 4], "set_ylim": [1, 4], "q": [1, 4], "v": [1, 4, 26], "03f": [1, 4], "xy": [1, 4], "va": [1, 4], "center": [1, 4], "norm": [1, 3, 4, 16, 17, 19, 26, 27, 29, 33, 49], "dim": [1, 4], "semilogx": [1, 4], "set_xlim": [1, 4], "loc": [1, 4, 55], "lower": [1, 4], "right": [1, 4, 25], "raw": 1, "themselv": 1, "regress": [2, 6], "level": [2, 7], "interfac": [2, 5], "ignit": [2, 5, 41, 43, 47, 49], "forc": [2, 4, 5, 6, 11, 52, 54], "against": 2, "analyt": 2, "tersoff": [2, 49], "system": [2, 5, 55], "train": [2, 3, 4, 5, 11, 40, 49, 54], "field": [2, 5, 6, 52, 54], "scratch": 2, "environ": 2, "initi": [2, 5, 17, 46], "tune": 2, "batch": [2, 3, 5, 6, 10, 11, 49, 55], "maxim": 2, "gpu": [2, 52], "product": 2, "togeth": [3, 10], "format": [3, 4, 5, 6, 10, 13, 38, 49, 55], "dft_3d": [3, 4, 55], "dataset": [3, 4, 6, 11, 13, 14, 41, 42, 43, 46, 49, 54], "dglgraph": [3, 6, 10, 11, 12, 16, 18, 19, 26, 33, 36, 55], "formation_energy_peratom": [3, 11, 55], "073": 3, "224": 3, "dataset_nam": [3, 55], "obtain": [3, 55], "3d": [3, 55], "76k": [3, 55], "natur": [3, 6, 55], "articl": [3, 55], "s41524": [3, 55], "020": [3, 55], "00440": [3, 55], "doi": [3, 26, 55], "org": [3, 18, 26, 55], "6084": [3, 55], "m9": [3, 55], "figshar": [3, 4, 55], "6815699": [3, 55], "40": [3, 16, 32, 55], "8m": 3, "ib": [3, 55], "52": [3, 55], "2k": [3, 55], "45": [3, 4], "385kib": 3, "209k": 3, "818kib": 3, "940k": 3, "83mib": 3, "81m": 3, "76mib": 3, "37m": 3, "9mib": 3, "33": [3, 55], "7m": 3, "27": [3, 55], "3mib": 3, "41": 3, "6m": 3, "1mib": 3, "54": [3, 55], "1m": 3, "26": [3, 55], "0m": 3, "34": 3, "6mib": 3, "74": 3, "30": [3, 40], "3m": 3, "35": 3, "8mib": 3, "4m": 3, "38": [3, 18], "num_nod": [3, 4, 55], "num_edg": [3, 55], "288": 3, "ndata_schem": [3, 55], "coord": [3, 55], "scheme": [3, 55], "shape": [3, 55], "float32": [3, 35, 36, 37, 55], "atomic_numb": [3, 55], "int32": [3, 55], "edata_schem": [3, 55], "4276": [3, 55], "structur": [3, 6, 10, 55], "contain": [3, 44, 55], "collect": [3, 4, 15], "poscar": 3, "cif": 3, "xyz": 3, "id_prop": 3, "csv": 3, "nfflr_root": 3, "getfil": 3, "sample_data": 3, "posixpath": [3, 40], "home": 3, "medium": 3, "cfg": [3, 55], "alignnconfig": [3, 4, 16, 55], "layernorm": [3, 16, 17, 19, 26, 29, 30, 33], "2389": 3, "grad_fn": [3, 55], "squeezebackward0": [3, 55], "meant": 3, "standard": [3, 11, 14], "common": [3, 6, 10, 47, 49], "atomist": [3, 5, 10, 16, 52, 55], "ml": 3, "collat": [3, 11], "properli": 3, "sampl": [3, 11], "tri": 3, "collate_fn": 3, "know": 3, "subsetrandomsampl": [3, 11], "batchsiz": 3, "train_load": 3, "batch_siz": [3, 40], "sampler": 3, "drop_last": 3, "2876": 3, "9240": 3, "0720": 3, "loop": 3, "quickstart": [3, 54], "tutori": 3, "more": 3, "context": 3, "beginn": 3, "basic": [3, 10, 23], "quickstart_tutori": 3, "mseloss": [3, 40], "adamw": [3, 6, 40], "training_loss": 3, "step": [3, 4], "enumer": 3, "backward": 3, "zero_grad": 3, "19": 3, "69it": 3, "85it": 3, "81it": 3, "32": 3, "23it": 3, "38it": 3, "91it": 3, "47": 3, "05it": 3, "53": 3, "58": 3, "27it": 3, "63": 3, "61it": 3, "68": 3, "75it": 3, "78it": 3, "79": 3, "15": [3, 36], "89": 3, "31it": 3, "48it": 3, "76it": 3, "49it": 3, "52it": 3, "73it": 3, "26it": 3, "99it": 3, "83it": 3, "13it": 3, "62it": 3, "71it": 3, "17it": 3, "53it": 3, "89it": 3, "25it": 3, "42it": 3, "64it": 3, "77it": 3, "86it": 3, "06it": 3, "82it": 3, "32it": 3, "72it": 3, "04it": 3, "01it": 3, "60it": 3, "41it": 3, "95it": 3, "94it": 3, "63it": 3, "07it": 3, "65it": 3, "09": 3, "74it": 3, "96it": 3, "18it": 3, "54it": 3, "15it": 3, "39it": 3, "68it": 3, "30it": 3, "70it": 3, "37it": 3, "keyboardinterrupt": 3, "_tensor": 3, "522": 3, "retain_graph": 3, "create_graph": 3, "512": 3, "has_torch_function_unari": 3, "513": 3, "handle_torch_funct": 3, "514": 3, "515": 3, "520": 3, "521": 3, "523": 3, "524": 3, "266": 3, "grad_tensor": 3, "grad_vari": 3, "261": 3, "263": 3, "repeat": 3, "comment": 3, "below": 3, "264": 3, "multi": [3, 6, 52], "265": 3, "_execution_engin": 3, "run_backward": 3, "engin": 3, "pass": 3, "267": 3, "268": 3, "grad_tensors_": 3, "269": 3, "270": 3, "271": 3, "272": 3, "allow_unreach": 3, "273": 3, "accumulate_grad": 3, "274": 3, "277": 3, "backwardcfunct": 3, "appli": [3, 32], "276": 3, "_c": 3, "_functionbas": 3, "functionctx": 3, "_hookmixin": 3, "278": 3, "_forward_cl": 3, "deriv": 3, "279": [3, 53], "either": 3, "vjp": 3, "never": 3, "280": 3, "backward_fn": 3, "type": [3, 20, 21], "ignor": 3, "attr": 3, "281": 3, "vjp_fn": 3, "semilogi": [3, 4], "tempfil": 3, "rank": [3, 11], "training_config": 3, "num_work": 3, "progress": [3, 40], "output_dir": [3, 40], "temporarydirectori": 3, "run_train": 3, "24": [3, 26, 53, 55], "46": 3, "979": 3, "auto_dataload": [3, 43], "loader": 3, "kwarg": 3, "collate_default": [3, 11], "0x29a06a560": 3, "0x107b71510": 3, "pin_memori": [3, 40], "0x30ec1da80": 3, "result": [3, 36], "avg": 3, "60": 3, "59": 3, "85": 3, "854463577270508": 3, "load_ext": 4, "autoreload": 4, "panda": [4, 55], "pd": 4, "scipi": 4, "functool": [4, 6], "partial": [4, 6], "tkagg": 4, "jarvi": [4, 6, 55], "db": 4, "jdata": 4, "periodic_adaptive_radius_graph": 4, "gnn": [4, 16, 17], "tfm": [4, 6], "datafram": [4, 11, 55], "ff": 4, "mpf": 4, "subset": 4, "jsonl": 4, "mp3": 4, "energy_and_forc": [4, 6, 55], "get_default_dtyp": 4, "json": [4, 6, 14], "estimate_reference_energi": [4, 11], "alignn_ff": 4, "cutoff_onset": 4, "tfmconfig": 4, "layer": [4, 17, 19, 27, 29, 33, 49], "importerror": 4, "1249": 4, "1244": 4, "1245": 4, "1246": 4, "1247": 4, "doe": 4, "librari": [4, 5, 55], "support": [4, 5, 6, 10, 52], "1248": 4, "chosen": 4, "switch_backend": 4, "1250": 4, "except": 4, "1251": 4, "350": 4, "newbackend": 4, "347": 4, "current_framework": 4, "cbook": 4, "_get_running_interactive_framework": 4, "348": 4, "required_framework": 4, "349": 4, "351": 4, "352": 4, "framework": 4, "353": 4, "355": 4, "new_figure_manag": 4, "356": 4, "357": 4, "export": 4, "358": 4, "backcompat": 4, "359": 4, "getattr": 4, "tk": 4, "headless": 4, "ckpt": 4, "checkpoint_200": 4, "devic": [4, 10, 11], "187416": 4, "187417": 4, "187418": 4, "et": [4, 26], "ep": [4, 28], "ft": 4, "fp": 4, "pval": 4, "fst": 4, "fsp": 4, "idx": 4, "p": 4, "_fp": 4, "ndim": 4, "unsqueez": 4, "ptrain": 4, "stack": 4, "vstack": 4, "pathcollect": 4, "0x2bb117f40": 4, "pseudolog10": 4, "asinh": 4, "pseudolog": 4, "_": [4, 11], "f_i": 4, "hat": 4, "_i": 4, "xlim": [4, 25, 34], "dco": 4, "cosine_similar": 4, "magt": 4, "magp": 4, "cmap": 4, "inferno": 4, "colorbar": 4, "hist": 4, "densiti": 4, "d_": 4, "co": [4, 18, 24, 25], "sel": 4, "ecdf_plot": 4, "axi": [4, 53, 55], "pct": 4, "80": [4, 16], "vmed": 4, "text": 4, "sgd": [4, 40], "momentum": 4, "schedul": [4, 40, 47], "lr_schedul": 4, "onecyclelr": 4, "max_lr": 4, "pct_start": 4, "steps_per_epoch": 4, "three_phas": 4, "final_div_factor": 4, "get_last_lr": 4, "line2d": 4, "0x2c5939810": 4, "neural": [5, 6, 26, 49], "toolkit": 5, "experiment": [5, 55], "intend": 5, "rapid": 5, "research": [5, 26, 55], "machin": [5, 26], "main": 5, "goal": [5, 10], "easili": 5, "extens": 5, "uniform": 5, "develop": 5, "deploi": 5, "codebas": 5, "fork": 5, "modifi": 5, "usabl": 5, "improv": 5, "github": [5, 14, 55], "primari": [5, 26, 55], "gener": [5, 52], "easi": [5, 10, 55], "effici": [5, 6, 55], "variou": [5, 55], "regardless": [5, 6], "materi": [5, 26], "report": 5, "bug": 5, "usnistgov": 5, "email": 5, "brian": 5, "decost": 5, "abl": 6, "preprocess": 6, "network": [6, 16, 26, 27, 49], "forward": [6, 16, 18, 19, 24, 26, 27, 29, 32, 33, 37], "pyg": [6, 10], "ghost": 6, "pad": 6, "nfflrmodel": 6, "vari": 6, "differ": [6, 55], "scalar": [6, 11, 55], "classif": 6, "where": [6, 55], "n_atom": 6, "n_spatial_dimens": 6, "might": 6, "simplifi": [6, 55], "workflow": 6, "These": [6, 55], "py_config_runn": 6, "flexibl": [6, 55], "two": [6, 27], "full": 6, "experi": 6, "transpar": [6, 55], "config": [6, 16, 17, 41, 42, 43, 44, 46, 47], "3e": 6, "sourc": [6, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48], "folder": 6, "document": [7, 18], "describ": 7, "top": 7, "api": 7, "batch_num_atom": 10, "int": [10, 11, 13, 16, 17, 19, 22, 23, 24, 26, 27, 29, 30, 31, 32, 33, 36, 40, 41, 42], "alignngraphtupl": 10, "matrix": [10, 55], "lattic": 10, "cartesian": [10, 55], "option": [10, 26, 40, 41, 42], "struct": 10, "attribut": [10, 16, 17, 40], "bool": [10, 11, 13, 14, 15, 16, 17, 20, 21, 26, 27, 33, 40], "determin": 10, "multipl": [10, 55], "scaled_posit": [10, 53, 55], "non_block": [10, 11], "transfer": 10, "mp": 10, "attempt": 10, "df": [11, 55], "custom_collate_fn": 11, "custom_prepare_batch_fn": 11, "train_val_se": 11, "id_tag": 11, "jid": [11, 55], "group_id": 11, "group_split_token": 11, "n_train": [11, 13], "n_val": [11, 13], "liter": [11, 16, 17, 18, 19, 23, 26, 28, 29, 30, 33, 40], "get_energy_and_forc": 11, "setup_target_standard": 11, "split_dataset_by_id": 11, "stratifi": 11, "trajectori": 11, "split_dataset": 11, "static": 11, "prepare_batch_default": 11, "tupl": [11, 16, 26, 38, 55], "send": 11, "helper": [11, 29, 52], "cross": 11, "concaten": 11, "along": 11, "dimens": 11, "global": 11, "whole": 11, "stess": 11, "collate_forcefield": 11, "heterograph": [12, 16], "noindex": 12, "datadir": [13, 15], "deepmd": 13, "cach": [14, 40, 55], "datafil": [14, 15], "materialsvirtuallab": [14, 55], "xdg_cache_hom": 14, "vasprun": 15, "xml": 15, "glob": 15, "xplor": [16, 49], "batchnorm": [16, 17, 19, 26, 29, 30, 33], "cgcnn": [16, 17, 23, 26, 55], "edge_input_featur": [16, 17], "triplet_input_featur": 16, "embedding_featur": 16, "hidden_featur": 16, "256": [16, 40], "output_featur": [16, 17, 26], "chain": 16, "altern": 16, "gate": [16, 26], "convolut": [16, 26, 49], "reset_atomic_reference_energi": [16, 17], "featur": [16, 19, 24, 26, 33, 36, 55], "ndata": 16, "edata": [16, 18], "lg": [16, 19, 33], "z": [16, 19, 33], "angl": [16, 18], "fix": [16, 17], "schema": [16, 17], "schnetconfig": 17, "128": 17, "d_model": [17, 22, 23, 31], "reset_paramet": [17, 27, 31], "reset_output_scal": 17, "avg_num_nod": 17, "init": 17, "std": 17, "param": 18, "tersoffconfig": 18, "paper": [18, 26], "1103": [18, 26], "physrevb": 18, "9902": 18, "doc": [18, 27], "pair_tersoff": 18, "fcut": 18, "style": 18, "smooth": 18, "f_repuls": 18, "pair": [18, 19, 20, 33], "repuls": 18, "f_attract": 18, "attract": 18, "angle_cosin": 18, "angular_term": 18, "zeta": 18, "edg": [18, 19, 26, 28, 30, 33, 55], "sum_": [18, 26], "neq": 18, "textrm": 18, "r_": [18, 25], "ik": 18, "theta": [18, 24], "exp": 18, "lambda_3": 18, "ij": [18, 26], "in_featur": [19, 29, 33], "out_featur": [19, 29, 33], "node": [19, 26, 28, 30, 33, 55], "speci": [20, 21], "symmetr": 20, "one_hot": [20, 21], "compact": [20, 21], "lookup": [20, 21], "tabl": [20, 21], "num_embed": 22, "118": 22, "cfid": 23, "basis_s": 24, "expand": [24, 32], "interv": 24, "chebyshev": 24, "trigonometr": 24, "definit": 24, "polynomi": 24, "lq": 24, "tn": 24, "r_cutoff": [25, 34], "pi": 25, "frac": 25, "cut": [25, 34], "linspac": [25, 34], "input_featur": 26, "residu": 26, "instancenorm": [26, 30, 49], "skip_edgenorm": 26, "xavier": 26, "bresson": 26, "thoma": 26, "laurent": 26, "convnet": 26, "arxiv": 26, "1711": 26, "07553": 26, "vijai": 26, "prakash": 26, "dwivedi": 26, "chaitanya": 26, "joshi": 26, "anh": 26, "tuan": 26, "luu": 26, "yoshua": 26, "bengio": 26, "benchmark": 26, "journal": 26, "48": 26, "2023": 26, "url": 26, "jmlr": 26, "v24": 26, "0567": 26, "tian": 26, "xie": 26, "jeffrei": 26, "grossman": 26, "accur": 26, "interpret": 26, "physic": 26, "review": 26, "letter": 26, "april": 26, "physrevlett": 26, "120": 26, "145301": 26, "detail": 26, "x_i": 26, "l": 26, "silu": [26, 29], "mathcal": 26, "eta_": 26, "x_j": 26, "similar": 26, "soft": 26, "attent": 26, "skip": 26, "connect": 26, "omit": 26, "normal": [26, 49], "node_feat": 26, "edge_feat": 26, "node_featur": 26, "edge_featur": 26, "d_in": 27, "d_hidden": 27, "d_out": 27, "multilay": 29, "perceptron": 29, "linear": 29, "num_featur": 30, "norm_typ": 30, "row": 31, "column": [31, 55], "vmin": 32, "vmax": 32, "lengthscal": 32, "distanc": [32, 36], "radial": [32, 36], "rbf": 32, "expans": 32, "skip_last_norm": 33, "sparser": 33, "y_mask": 33, "r_onset": 34, "inner": 34, "adapt": 35, "period": [35, 36, 37], "shell": 36, "index": 36, "maximum": 36, "consid": 36, "unpack": 38, "spglib": 38, "onecycl": 40, "gradient_accumulation_step": 40, "swag": 40, "resume_checkpoint": 40, "train_eval_fract": 40, "artifact": 40, "save": 40, "consol": 40, "bar": 40, "local_rank": [41, 42], "ai": 41, "handler": [41, 47], "lr_finder": 41, "fastailrfind": 41, "state": 44, "least": 44, "prepare_batch": [45, 47], "transfer_output": 45, "attach": 47, "event": 47, "convers": [49, 55], "periodickshellgraph": 49, "periodicadaptiveradiusgraph": 49, "atomtyp": 49, "atompairtyp": 49, "attributeembed": 49, "atomicnumberembed": 49, "periodictableembed": 49, "deepmd_hea_dataset": 49, "vasprun_dataset": 49, "rbfexpans": 49, "chebyshevexpans": 49, "edgegatedgraphconv": 49, "alignnconv": 49, "sparsealignnconv": 49, "feedforward": 49, "mlplayer": 49, "schnet": 49, "setup": 49, "get_dataflow": 49, "setup_model_and_optim": 49, "setup_train": 49, "setup_checkpoint": 49, "setup_evalu": 49, "ey": [53, 55], "125": 53, "0000": [53, 55], "0500": [53, 55], "_batch_num_atom": [53, 55], "jmol_color": 53, "visual": [53, 55], "plot_atom": [53, 55], "ase_atom": [53, 55], "to_as": [53, 55], "radii": [53, 55], "rotat": [53, 55], "10x": [53, 55], "20y": [53, 55], "0z": [53, 55], "show_unit_cel": [53, 55], "repres": 55, "store": 55, "facilit": 55, "deep": 55, "588": 55, "739": 55, "aseatom": 55, "approach": 55, "varieti": 55, "aim": 55, "exploratori": 55, "intern": 55, "nativ": 55, "alignn_model": 55, "no_grad": 55, "warn": 55, "103": 55, "102": 55, "3866": 55, "plum": 55, "dispatch": 55, "caus": 55, "its": 55, "neg": 55, "3729": 55, "6822e": 55, "6578e": 55, "9477e": 55, "8312e": 55, "1793e": 55, "4261e": 55, "mulbackward0": 55, "3659e": 55, "2666e": 55, "0117e": 55, "6382e": 55, "6508e": 55, "6605e": 55, "segmentreducebackward": 55, "3757": 55, "6226e": 55, "1526e": 55, "0565e": 55, "9605e": 55, "0265e": 55, "0826e": 55, "3447e": 55, "7684e": 55, "instanc": 55, "5669": 55, "3971": 55, "6752": 55, "3761": 55, "8917": 55, "0210": 55, "6985": 55, "8895": 55, "5076": 55, "29": 55, "quantiti": 55, "selected_col": 55, "formula": 55, "optb88vdw_bandgap": 55, "elastic_tensor": 55, "jvasp": 55, "90856": 55, "ticusia": 55, "42762": 55, "000": 55, "na": 55, "86097": 55, "dyb6": 55, "41596": 55, "64906": 55, "be2osru": 55, "04847": 55, "98225": 55, "kbi": 55, "44140": 55, "472": 55, "vse2": 55, "71026": 55, "136": 55, "handl": 55, "manual": 55, "4000": 55, "8000": 55, "5000": 55, "7000": 55, "3000": 55, "alignn_ff_db": 55, "m3gnet": 55, "special": 55, "thei": 55, "1730": 55, "57m": 55, "379kib": 55, "226k": 55, "889kib": 55, "39": 55, "992k": 55, "97mib": 55, "15mib": 55, "604": 55, "2623": 55, "9282e": 55, "8793e": 55, "6374e": 55, "2543e": 55, "0313e": 55, "6808e": 55, "5372e": 55, "4736e": 55, "2997e": 55, "5678e": 55, "1175e": 55, "0934e": 55, "6499e": 55, "6259e": 55, "5255e": 55, "6698e": 55, "8080e": 55, "7749e": 55, "6802e": 55, "1423e": 55, "0166e": 55, "0730e": 55, "5780e": 55, "1357e": 55, "9132e": 55, "1381e": 55, "4296e": 55, "0090e": 55, "5143e": 55, "5578e": 55, "7128e": 55, "7808e": 55, "4215e": 55, "3987e": 55, "6757e": 55, "9322e": 55, "7190e": 55, "0627e": 55, "2933e": 55, "6458e": 55, "6833e": 55, "0043e": 55, "5756e": 55, "5868e": 55, "7038e": 55, "2044e": 55, "3979e": 55, "5036e": 55, "5743e": 55, "4479e": 55, "7272e": 55, "8223e": 55, "5903e": 55, "7198e": 55, "9518e": 55, "7982e": 55, "6208e": 55, "3000e": 55, "7643e": 55, "0947e": 55, "3517e": 55, "4522e": 55, "6359e": 55, "4930e": 55, "1648e": 55, "1246e": 55, "8361e": 55, "0337e": 55, "0099e": 55, "4334e": 55, "4563e": 55, "8775e": 55, "2193e": 55, "8368e": 55, "7678e": 55, "8822e": 55, "3724e": 55, "0373e": 55, "7925e": 55, "4629e": 55, "7126e": 55, "3972e": 55, "1936e": 55, "4154e": 55, "0657e": 55, "6893e": 55, "3909e": 55, "2667e": 55, "9585e": 55, "0468e": 55, "3723e": 55, "7657e": 55, "4826e": 55, "3950e": 55, "1809e": 55, "7236e": 55, "0571e": 55, "0909e": 55, "3469e": 55, "2798e": 55, "3690e": 55, "8363e": 55, "3372e": 55, "8005e": 55, "0848e": 55, "7622e": 55, "1141e": 55, "8884e": 55, "1697e": 55, "0889e": 55, "3894e": 55, "1740e": 55, "2013e": 55, "5727e": 55, "5217e": 55, "6934e": 55, "8191e": 55, "4829e": 55, "2664e": 55, "1411e": 55, "2328e": 55, "2866e": 55, "1776e": 55, "2366e": 55, "5056e": 55, "3455e": 55, "8714e": 55, "4488e": 55, "2792e": 55, "0664e": 55, "4243e": 55, "2686e": 55, "3897e": 55, "7333e": 55, "4011e": 55, "0459e": 55, "1634e": 55, "0630e": 55, "9009e": 55, "2214e": 55, "4072e": 55, "3802e": 55, "1611e": 55, "3336e": 55, "2308e": 55, "7998e": 55, "0719e": 55, "5169e": 55, "4886e": 55, "4431e": 55, "3966e": 55, "3065e": 55, "9503e": 55, "8711e": 55, "6996e": 55, "6954e": 55, "0038e": 55, "8048e": 55, "6736e": 55, "8896e": 55, "9839e": 55, "1865e": 55, "0303e": 55, "5889e": 55, "0517e": 55, "4835e": 55, "5193e": 55, "8107e": 55, "3507e": 55, "6680e": 55, "6512e": 55, "6324e": 55, "0497e": 55, "7391e": 55, "7163e": 55, "8480e": 55, "0546e": 55, "5508e": 55, "4519e": 55, "3183e": 55, "4062e": 55, "8017e": 55, "4209e": 55, "2076e": 55, "1055e": 55, "7652e": 55, "7866e": 55, "0725e": 55, "5774e": 55, "6219e": 55, "1061e": 55, "6820e": 55, "5689e": 55, "1297e": 55, "2079e": 55, "3750e": 55, "6904e": 55, "2430e": 55, "5449e": 55, "4885e": 55, "6164e": 55, "6403e": 55, "3929e": 55, "3473e": 55, "0026e": 55, "1965e": 55, "8875e": 55, "0416e": 55, "0578e": 55, "4767e": 55, "7263e": 55, "0396e": 55, "0797e": 55, "2834e": 55, "0441e": 55, "1592e": 55, "0053e": 55, "6651e": 55, "4538e": 55, "1315e": 55, "5051e": 55, "6349e": 55, "9915e": 55, "2209e": 55, "3324e": 55, "9588e": 55, "1156e": 55, "3736e": 55, "2689e": 55, "6983e": 55, "8699e": 55, "6415e": 55, "2089e": 55, "2056e": 55, "2394e": 55, "3969e": 55, "1350e": 55, "1012e": 55, "5827e": 55, "9145e": 55, "8987e": 55, "7861e": 55, "4112e": 55, "7514e": 55, "0377e": 55, "6119e": 55, "6974e": 55, "9227e": 55, "5502e": 55, "6419e": 55, "3265e": 55, "1135e": 55, "0431e": 55, "3025e": 55, "0777e": 55, "4116e": 55, "6561e": 55, "2870e": 55, "4176e": 55, "1487e": 55, "5266e": 55, "2469e": 55, "5254e": 55, "2129e": 55, "1837e": 55, "5957e": 55, "3009e": 55, "3448e": 55, "8741e": 55, "7946e": 55, "5803e": 55, "9431e": 55, "3611e": 55, "3890e": 55, "3396e": 55, "8913e": 55, "6739e": 55, "8580e": 55, "4732e": 55, "2845e": 55, "9202e": 55, "6483e": 55, "3382e": 55, "9371e": 55, "8642e": 55, "4136e": 55, "5257e": 55, "5428e": 55, "2954e": 55, "2409e": 55, "3798e": 55, "2413e": 55, "5878e": 55, "6709e": 55, "0508e": 55, "7083e": 55, "0494e": 55, "1418e": 55, "9075e": 55, "6860e": 55, "3186e": 55, "9992e": 55, "1271e": 55, "7508e": 55, "2828e": 55, "0157e": 55, "2795e": 55, "9179e": 55, "6428e": 55, "5829e": 55, "1079e": 55, "volum": 55, "1165": 55, "6177": 55}, "objects": {"": [[9, 0, 0, "-", "nfflr"]], "nfflr": [[10, 1, 1, "", "Atoms"], [11, 1, 1, "", "AtomsDataset"], [12, 3, 1, "id0", "batch"], [9, 0, 0, "-", "data"], [50, 0, 0, "-", "models"], [51, 0, 0, "-", "nn"], [38, 3, 1, "", "spglib_cell"], [39, 3, 1, "", "to_ase"], [52, 0, 0, "-", "train"], [48, 3, 1, "", "unbatch"]], "nfflr.Atoms": [[10, 2, 1, "", "batched"], [10, 2, 1, "", "scaled_positions"], [10, 2, 1, "", "to"]], "nfflr.AtomsDataset": [[11, 2, 1, "", "collate_default"], [11, 2, 1, "", "collate_forcefield"], [11, 2, 1, "", "prepare_batch_default"], [11, 2, 1, "", "split_dataset"], [11, 2, 1, "", "split_dataset_by_id"]], "nfflr.data": [[13, 3, 1, "", "deepmd_hea_dataset"], [14, 3, 1, "", "mlearn_dataset"], [15, 3, 1, "", "vasprun_dataset"]], "nfflr.models": [[16, 1, 1, "", "ALIGNN"], [16, 1, 1, "", "ALIGNNConfig"], [17, 1, 1, "", "SchNet"], [17, 1, 1, "", "SchNetConfig"], [18, 1, 1, "", "Tersoff"], [18, 1, 1, "", "TersoffConfig"]], "nfflr.models.ALIGNN": [[16, 2, 1, "id0", "forward"]], "nfflr.models.SchNet": [[17, 2, 1, "", "reset_output_scale"]], "nfflr.models.Tersoff": [[18, 2, 1, "", "angular_term"], [18, 2, 1, "", "f_attractive"], [18, 2, 1, "", "f_repulsive"], [18, 2, 1, "", "fcut"], [18, 2, 1, "", "forward"], [18, 2, 1, "", "g"]], "nfflr.nn": [[19, 1, 1, "", "ALIGNNConv"], [20, 1, 1, "", "AtomPairType"], [21, 1, 1, "", "AtomType"], [22, 1, 1, "", "AtomicNumberEmbedding"], [23, 1, 1, "", "AttributeEmbedding"], [24, 1, 1, "", "ChebyshevExpansion"], [25, 1, 1, "", "Cosine"], [26, 1, 1, "", "EdgeGatedGraphConv"], [27, 1, 1, "", "FeedForward"], [28, 1, 1, "", "InstanceNorm"], [29, 1, 1, "", "MLPLayer"], [30, 1, 1, "", "Norm"], [31, 1, 1, "", "PeriodicTableEmbedding"], [32, 1, 1, "", "RBFExpansion"], [33, 1, 1, "", "SparseALIGNNConv"], [34, 1, 1, "", "XPLOR"]], "nfflr.nn.ALIGNNConv": [[19, 2, 1, "", "forward"]], "nfflr.nn.ChebyshevExpansion": [[24, 2, 1, "", "forward"]], "nfflr.nn.EdgeGatedGraphConv": [[26, 2, 1, "", "forward"]], "nfflr.nn.FeedForward": [[27, 2, 1, "", "forward"]], "nfflr.nn.MLPLayer": [[29, 2, 1, "", "forward"]], "nfflr.nn.RBFExpansion": [[32, 2, 1, "", "forward"]], "nfflr.nn.SparseALIGNNConv": [[33, 2, 1, "", "forward"]], "nfflr.nn.transform": [[35, 1, 1, "", "PeriodicAdaptiveRadiusGraph"], [36, 1, 1, "", "PeriodicKShellGraph"], [37, 1, 1, "", "PeriodicRadiusGraph"]], "nfflr.nn.transform.PeriodicRadiusGraph": [[37, 2, 1, "", "forward"]], "nfflr.train": [[40, 1, 1, "", "TrainingConfig"], [41, 3, 1, "", "lr"], [42, 3, 1, "", "train"], [52, 0, 0, "-", "trainer"]], "nfflr.train.trainer": [[43, 3, 1, "", "get_dataflow"], [44, 3, 1, "", "setup_checkpointing"], [45, 3, 1, "", "setup_evaluators"], [46, 3, 1, "", "setup_model_and_optimizer"], [47, 3, 1, "", "setup_trainer"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"]}, "titleterms": {"check": 0, "autograd": 0, "forc": [0, 1, 55], "against": 0, "analyt": 0, "tersoff": [0, 18], "potenti": [0, 50], "small": 0, "silicon": 0, "system": 0, "train": [1, 6, 41, 42, 43, 44, 45, 46, 47, 52, 55], "field": [1, 55], "from": [1, 4], "scratch": 1, "environ": 1, "initi": 1, "configur": [1, 52], "file": 1, "section": 1, "model": [1, 6, 50, 55], "dataset": [1, 9, 55], "tune": 1, "batch": [1, 8, 12], "size": 1, "maxim": 1, "gpu": 1, "util": [1, 55], "assess": 1, "product": 1, "run": 1, "full": 1, "script": 1, "config": 1, "py": 1, "evalu": 1, "how": 2, "guid": 2, "properti": 3, "regress": 3, "exampl": [3, 4], "low": 3, "level": 3, "interfac": [3, 6, 55], "us": 3, "ignit": [3, 6, 52], "base": [3, 6, 52], "nfflr": [3, 5, 7, 8, 9, 12, 13, 14, 15, 38, 39, 41, 42, 43, 44, 45, 46, 47, 48, 50, 51], "trainer": [3, 6, 43, 44, 45, 46, 47, 52], "an": 4, "load": 4, "checkpoint": 4, "document": 5, "project": 5, "histori": 5, "correspond": 5, "code": 5, "conduct": 5, "overview": 6, "input": [6, 55], "represent": [6, 8, 55], "output": 6, "command": 6, "atom": [8, 10, 53, 55], "convers": 8, "other": 8, "format": 8, "graph": [8, 50, 51], "construct": 8, "atomsdataset": [9, 11, 55], "pre": 9, "packag": 9, "data": [13, 14, 15, 55], "deepmd_hea_dataset": 13, "mlearn_dataset": 14, "vasprun_dataset": 15, "alignn": 16, "schnet": 17, "alignnconv": 19, "atompairtyp": 20, "atomtyp": 21, "atomicnumberembed": 22, "attributeembed": 23, "chebyshevexpans": 24, "cosin": 25, "edgegatedgraphconv": 26, "feedforward": 27, "instancenorm": 28, "mlplayer": 29, "norm": 30, "periodictableembed": 31, "rbfexpans": 32, "sparsealignnconv": 33, "xplor": 34, "periodicadaptiveradiusgraph": 35, "periodickshellgraph": 36, "periodicradiusgraph": 37, "spglib_cel": 38, "to_as": 39, "trainingconfig": 40, "lr": 41, "get_dataflow": 43, "setup_checkpoint": 44, "setup_evalu": 45, "setup_model_and_optim": 46, "setup_train": 47, "unbatch": 48, "refer": 49, "neural": 50, "network": 50, "classic": 50, "interatom": 50, "nn": 51, "basi": 51, "function": 51, "convolut": 51, "layer": 51, "cutoff": 51, "common": [51, 55], "normal": 51, "setup": 52, "tutori": 54, "quickstart": 55}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinxcontrib.bibtex": 9, "sphinx": 60}, "alltitles": {"Check autograd forces against analytical forces": [[0, "check-autograd-forces-against-analytical-forces"]], "Tersoff potential": [[0, "tersoff-potential"]], "Small silicon system": [[0, "small-silicon-system"]], "Train a force field from scratch": [[1, "train-a-force-field-from-scratch"]], "environment": [[1, "environment"]], "initial configuration file": [[1, "initial-configuration-file"]], "training configuration section": [[1, "training-configuration-section"]], "model section": [[1, "model-section"]], "dataset section": [[1, "dataset-section"]], "tune batch size to maximize GPU utilization": [[1, "tune-batch-size-to-maximize-gpu-utilization"]], "assessing GPU utilization": [[1, "assessing-gpu-utilization"]], "production training run": [[1, "production-training-run"]], "full configuration script (config.py)": [[1, null]], "evaluation": [[1, "evaluation"]], "How-to guides": [[2, "how-to-guides"]], "Property regression example": [[3, "property-regression-example"]], "low level interface": [[3, "low-level-interface"]], "using the ignite-based NFFLr trainer": [[3, "using-the-ignite-based-nfflr-trainer"]], "an example": [[4, "an-example"]], "loading from a checkpoint": [[4, "loading-from-a-checkpoint"]], "NFFLr documentation": [[5, "nfflr-documentation"]], "Project history": [[5, null]], "Correspondence": [[5, "correspondence"]], "Code of conduct": [[5, "code-of-conduct"]], "Overview": [[6, "overview"]], "input representation": [[6, "input-representation"]], "modeling interface": [[6, "modeling-interface"]], "output representation": [[6, "output-representation"]], "ignite-based trainer": [[6, "ignite-based-trainer"], [52, "module-nfflr.train"]], "training command": [[6, "training-command"]], "nfflr": [[7, "nfflr"]], "nfflr.Atoms": [[8, "nfflr-atoms"]], "Atoms": [[8, "atoms"], [10, "atoms"], [53, "atoms"]], "batching": [[8, "batching"]], "conversion to other formats": [[8, "conversion-to-other-formats"]], "Graph construction": [[8, "graph-construction"]], "atom representations": [[8, "atom-representations"]], "nfflr.AtomsDataset": [[9, "nfflr-atomsdataset"]], "AtomsDataset": [[9, "module-nfflr"], [11, "atomsdataset"], [55, "atomsdataset"]], "pre-packaged datasets": [[9, "module-nfflr.data"]], "nfflr.batch": [[12, "nfflr-batch"]], "nfflr.data.deepmd_hea_dataset": [[13, "nfflr-data-deepmd-hea-dataset"]], "nfflr.data.mlearn_dataset": [[14, "nfflr-data-mlearn-dataset"]], "nfflr.data.vasprun_dataset": [[15, "nfflr-data-vasprun-dataset"]], "ALIGNN": [[16, "alignn"]], "SchNet": [[17, "schnet"]], "Tersoff": [[18, "tersoff"]], "ALIGNNConv": [[19, "alignnconv"]], "AtomPairType": [[20, "atompairtype"]], "AtomType": [[21, "atomtype"]], "AtomicNumberEmbedding": [[22, "atomicnumberembedding"]], "AttributeEmbedding": [[23, "attributeembedding"]], "ChebyshevExpansion": [[24, "chebyshevexpansion"]], "Cosine": [[25, "cosine"]], "EdgeGatedGraphConv": [[26, "edgegatedgraphconv"]], "FeedForward": [[27, "feedforward"]], "InstanceNorm": [[28, "instancenorm"]], "MLPLayer": [[29, "mlplayer"]], "Norm": [[30, "norm"]], "PeriodicTableEmbedding": [[31, "periodictableembedding"]], "RBFExpansion": [[32, "rbfexpansion"]], "SparseALIGNNConv": [[33, "sparsealignnconv"]], "XPLOR": [[34, "xplor"]], "PeriodicAdaptiveRadiusGraph": [[35, "periodicadaptiveradiusgraph"]], "PeriodicKShellGraph": [[36, "periodickshellgraph"]], "PeriodicRadiusGraph": [[37, "periodicradiusgraph"]], "nfflr.spglib_cell": [[38, "nfflr-spglib-cell"]], "nfflr.to_ase": [[39, "nfflr-to-ase"]], "TrainingConfig": [[40, "trainingconfig"]], "nfflr.train.lr": [[41, "nfflr-train-lr"]], "nfflr.train.train": [[42, "nfflr-train-train"]], "nfflr.train.trainer.get_dataflow": [[43, "nfflr-train-trainer-get-dataflow"]], "nfflr.train.trainer.setup_checkpointing": [[44, "nfflr-train-trainer-setup-checkpointing"]], "nfflr.train.trainer.setup_evaluators": [[45, "nfflr-train-trainer-setup-evaluators"]], "nfflr.train.trainer.setup_model_and_optimizer": [[46, "nfflr-train-trainer-setup-model-and-optimizer"]], "nfflr.train.trainer.setup_trainer": [[47, "nfflr-train-trainer-setup-trainer"]], "nfflr.unbatch": [[48, "nfflr-unbatch"]], "Reference": [[49, "reference"]], "nfflr.models": [[50, "module-nfflr.models"]], "Graph neural networks": [[50, "graph-neural-networks"]], "Classical interatomic potentials": [[50, "classical-interatomic-potentials"]], "nfflr.nn": [[51, "module-nfflr.nn"]], "Basis functions": [[51, "basis-functions"]], "Graph convolution layers": [[51, "graph-convolution-layers"]], "Cutoff functions": [[51, "cutoff-functions"]], "Common layers": [[51, "common-layers"]], "Normalization layers": [[51, "normalization-layers"]], "trainer": [[52, "trainer"]], "Configuration": [[52, "module-nfflr.train"]], "training setup": [[52, "module-nfflr.train.trainer"]], "Tutorials": [[54, "tutorials"]], "Quickstart": [[55, "quickstart"]], "Atoms Data": [[55, "atoms-data"]], "Models": [[55, "models"]], "Common model interface": [[55, "common-model-interface"]], "Force field models": [[55, "force-field-models"]], "input representations": [[55, "input-representations"]], "Training utilities": [[55, "training-utilities"]], "Force field datasets": [[55, "force-field-datasets"]]}, "indexentries": {"batch() (in module nfflr)": [[8, "nfflr.batch"], [12, "id0"], [12, "nfflr.batch"]], "module": [[9, "module-nfflr"], [9, "module-nfflr.data"], [50, "module-nfflr.models"], [51, "module-nfflr.nn"], [52, "module-nfflr.train"], [52, "module-nfflr.train.trainer"]], "nfflr": [[9, "module-nfflr"]], "nfflr.data": [[9, "module-nfflr.data"]], "atoms (class in nfflr)": [[10, "nfflr.Atoms"]], "batched() (nfflr.atoms method)": [[10, "nfflr.Atoms.batched"]], "scaled_positions() (nfflr.atoms method)": [[10, "nfflr.Atoms.scaled_positions"]], "to() (nfflr.atoms method)": [[10, "nfflr.Atoms.to"]], "atomsdataset (class in nfflr)": [[11, "nfflr.AtomsDataset"]], "collate_default() (nfflr.atomsdataset static method)": [[11, "nfflr.AtomsDataset.collate_default"]], "collate_forcefield() (nfflr.atomsdataset static method)": [[11, "nfflr.AtomsDataset.collate_forcefield"]], "prepare_batch_default() (nfflr.atomsdataset static method)": [[11, "nfflr.AtomsDataset.prepare_batch_default"]], "split_dataset() (nfflr.atomsdataset method)": [[11, "nfflr.AtomsDataset.split_dataset"]], "split_dataset_by_id() (nfflr.atomsdataset method)": [[11, "nfflr.AtomsDataset.split_dataset_by_id"]], "deepmd_hea_dataset() (in module nfflr.data)": [[13, "nfflr.data.deepmd_hea_dataset"]], "mlearn_dataset() (in module nfflr.data)": [[14, "nfflr.data.mlearn_dataset"]], "vasprun_dataset() (in module nfflr.data)": [[15, "nfflr.data.vasprun_dataset"]], "alignn (class in nfflr.models)": [[16, "nfflr.models.ALIGNN"]], "alignn.forward() (in module nfflr.models)": [[16, "nfflr.models.ALIGNN.forward"]], "alignnconfig (class in nfflr.models)": [[16, "nfflr.models.ALIGNNConfig"]], "forward() (nfflr.models.alignn method)": [[16, "id0"]], "schnet (class in nfflr.models)": [[17, "nfflr.models.SchNet"]], "schnetconfig (class in nfflr.models)": [[17, "nfflr.models.SchNetConfig"]], "reset_output_scale() (nfflr.models.schnet method)": [[17, "nfflr.models.SchNet.reset_output_scale"]], "tersoff (class in nfflr.models)": [[18, "nfflr.models.Tersoff"]], "tersoffconfig (class in nfflr.models)": [[18, "nfflr.models.TersoffConfig"]], "angular_term() (nfflr.models.tersoff method)": [[18, "nfflr.models.Tersoff.angular_term"]], "f_attractive() (nfflr.models.tersoff method)": [[18, "nfflr.models.Tersoff.f_attractive"]], "f_repulsive() (nfflr.models.tersoff method)": [[18, "nfflr.models.Tersoff.f_repulsive"]], "fcut() (nfflr.models.tersoff method)": [[18, "nfflr.models.Tersoff.fcut"]], "forward() (nfflr.models.tersoff method)": [[18, "nfflr.models.Tersoff.forward"]], "g() (nfflr.models.tersoff method)": [[18, "nfflr.models.Tersoff.g"]], "alignnconv (class in nfflr.nn)": [[19, "nfflr.nn.ALIGNNConv"]], "forward() (nfflr.nn.alignnconv method)": [[19, "nfflr.nn.ALIGNNConv.forward"]], "atompairtype (class in nfflr.nn)": [[20, "nfflr.nn.AtomPairType"]], "atomtype (class in nfflr.nn)": [[21, "nfflr.nn.AtomType"]], "atomicnumberembedding (class in nfflr.nn)": [[22, "nfflr.nn.AtomicNumberEmbedding"]], "attributeembedding (class in nfflr.nn)": [[23, "nfflr.nn.AttributeEmbedding"]], "chebyshevexpansion (class in nfflr.nn)": [[24, "nfflr.nn.ChebyshevExpansion"]], "forward() (nfflr.nn.chebyshevexpansion method)": [[24, "nfflr.nn.ChebyshevExpansion.forward"]], "cosine (class in nfflr.nn)": [[25, "nfflr.nn.Cosine"]], "edgegatedgraphconv (class in nfflr.nn)": [[26, "nfflr.nn.EdgeGatedGraphConv"]], "forward() (nfflr.nn.edgegatedgraphconv method)": [[26, "nfflr.nn.EdgeGatedGraphConv.forward"]], "feedforward (class in nfflr.nn)": [[27, "nfflr.nn.FeedForward"]], "forward() (nfflr.nn.feedforward method)": [[27, "nfflr.nn.FeedForward.forward"]], "instancenorm (class in nfflr.nn)": [[28, "nfflr.nn.InstanceNorm"]], "mlplayer (class in nfflr.nn)": [[29, "nfflr.nn.MLPLayer"]], "forward() (nfflr.nn.mlplayer method)": [[29, "nfflr.nn.MLPLayer.forward"]], "norm (class in nfflr.nn)": [[30, "nfflr.nn.Norm"]], "periodictableembedding (class in nfflr.nn)": [[31, "nfflr.nn.PeriodicTableEmbedding"]], "rbfexpansion (class in nfflr.nn)": [[32, "nfflr.nn.RBFExpansion"]], "forward() (nfflr.nn.rbfexpansion method)": [[32, "nfflr.nn.RBFExpansion.forward"]], "sparsealignnconv (class in nfflr.nn)": [[33, "nfflr.nn.SparseALIGNNConv"]], "forward() (nfflr.nn.sparsealignnconv method)": [[33, "nfflr.nn.SparseALIGNNConv.forward"]], "xplor (class in nfflr.nn)": [[34, "nfflr.nn.XPLOR"]], "periodicadaptiveradiusgraph (class in nfflr.nn.transform)": [[35, "nfflr.nn.transform.PeriodicAdaptiveRadiusGraph"]], "periodickshellgraph (class in nfflr.nn.transform)": [[36, "nfflr.nn.transform.PeriodicKShellGraph"]], "periodicradiusgraph (class in nfflr.nn.transform)": [[37, "nfflr.nn.transform.PeriodicRadiusGraph"]], "forward() (nfflr.nn.transform.periodicradiusgraph method)": [[37, "nfflr.nn.transform.PeriodicRadiusGraph.forward"]], "spglib_cell() (in module nfflr)": [[38, "nfflr.spglib_cell"]], "to_ase() (in module nfflr)": [[39, "nfflr.to_ase"]], "trainingconfig (class in nfflr.train)": [[40, "nfflr.train.TrainingConfig"]], "lr() (in module nfflr.train)": [[41, "nfflr.train.lr"]], "train() (in module nfflr.train)": [[42, "nfflr.train.train"]], "get_dataflow() (in module nfflr.train.trainer)": [[43, "nfflr.train.trainer.get_dataflow"]], "setup_checkpointing() (in module nfflr.train.trainer)": [[44, "nfflr.train.trainer.setup_checkpointing"]], "setup_evaluators() (in module nfflr.train.trainer)": [[45, "nfflr.train.trainer.setup_evaluators"]], "setup_model_and_optimizer() (in module nfflr.train.trainer)": [[46, "nfflr.train.trainer.setup_model_and_optimizer"]], "setup_trainer() (in module nfflr.train.trainer)": [[47, "nfflr.train.trainer.setup_trainer"]], "unbatch() (in module nfflr)": [[48, "nfflr.unbatch"]], "nfflr.models": [[50, "module-nfflr.models"]], "nfflr.nn": [[51, "module-nfflr.nn"]], "nfflr.train": [[52, "module-nfflr.train"]], "nfflr.train.trainer": [[52, "module-nfflr.train.trainer"]]}})